# -*- coding: utf-8 -*-
"""
Created on Fri Jul 31 11:43:30 2020

@author: Derek Joslin
"""

import sys
import HapticsEngine as he
import time

from qtpy.QtWidgets import QApplication
from pyqtconsole.console import PythonConsole
import pyqtconsole.highlighter as hl


#timing matrices
ts = [[20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, 40, ],
      [40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 20, ]]

th = [[10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ],
      [10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, 10, 30, 30, 30, ],
      [10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, 10, 80, 80, 80, ]]

tpw = [[100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ],
       [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, ]]


#create the backend haptics engine
engine = he.HapticsEngine(tpw,th,ts, 20, 20, 'row by row')


def display_matrix(matrix,number):
    print(chr(27) + "[2J")
    print('time: {0}'.format(number))
    print('---------------------------\n\r')
    print('\n'.join([' '.join(['{:4}'.format(item) for item in row])
                 for row in matrix]))

def erase(onOff):
    if onOff == "on":
        engine.ge.set_output(0)
    else:
        engine.ge.set_output(1)

def dot(coord):
    engine.ge.select_element(coord)
    print("desired state \n")
    display_matrix(engine.get_currentState, 0)
    
def line(start, end, width):
    engine.ge.make_line(start, end, width)
    print("desired state \n")
    display_matrix(engine.get_currentState, 0)
    
def curve(start, control1, control2, end, width):
    engine.ge.make_bezierCurve(start, control1, control2, end, width)
    print("desired state \n")
    display_matrix(engine.get_currentState, 0)
    


if __name__ == '__main__':
    app = QApplication([])

    #console creation
    console = PythonConsole(formats={
    'keyword':    hl.format('blue', 'bold'),
    'operator':   hl.format('red'),
    'brace':      hl.format('darkGray'),
    'defclass':   hl.format('black', 'bold'),
    'string':     hl.format('magenta'),
    'string2':    hl.format('darkMagenta'),
    'comment':    hl.format('darkGreen', 'italic'),
    'self':       hl.format('black', 'italic'),
    'numbers':    hl.format('brown'),
    'inprompt':   hl.format('darkBlue', 'bold'),
    'outprompt':  hl.format('darkRed', 'bold'),
    })
    
    
    #
    console.push_local_ns('greet', greet)
    console.show()

    console.eval_queued()

    sys.exit(app.exec_())
    
    
    
    